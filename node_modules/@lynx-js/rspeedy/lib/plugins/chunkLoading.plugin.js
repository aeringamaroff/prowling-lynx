import { ChunkLoadingWebpackPlugin } from '@lynx-js/chunk-loading-webpack-plugin';
export function pluginChunkLoading() {
    return {
        name: 'lynx:rsbuild:chunk-loading',
        setup(api) {
            api.modifyBundlerChain(chain => {
                // dprint-ignore
                chain
                    .plugin('lynx:chunk-loading')
                    .use(ChunkLoadingWebpackPlugin)
                    .end()
                    .output
                    // Rspack needs `chunkLoading: 'require'` since we use runtimeModule hook
                    // to override the chunk loading runtime.
                    .chunkLoading('require')
                    .chunkFormat('commonjs')
                    .iife(false)
                    .end();
            });
            api.modifyWebpackChain(chain => {
                chain
                    .output
                    // For webpack, we directly use `chunkLoading: 'lynx'`.
                    .chunkLoading('lynx')
                    .end();
            });
        },
    };
}
//# sourceMappingURL=chunkLoading.plugin.js.map